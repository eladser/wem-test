# WEM Dashboard - Comprehensive Logging & Error Handling System\n\nThis document describes the comprehensive logging and error handling system implemented for both frontend and backend components of the WEM Dashboard.\n\n## üéØ Overview\n\nThe system provides:\n- **Frontend**: Global error boundaries, logging utilities, API client with error handling, user-friendly error pages\n- **Backend**: Structured logging with Serilog, custom middleware for error handling and request logging, centralized error management\n- **Integration**: Frontend errors are automatically sent to backend for centralized logging and analysis\n\n## üöÄ Features\n\n### Frontend Features\n- ‚úÖ Global error boundary with fallback UI\n- ‚úÖ Comprehensive logging system (debug, info, warn, error, fatal)\n- ‚úÖ Automatic error reporting to backend\n- ‚úÖ Performance monitoring and timing\n- ‚úÖ User-friendly error pages with error IDs\n- ‚úÖ API client with automatic retry and error handling\n- ‚úÖ Toast notifications for user feedback\n- ‚úÖ Development vs production error handling\n\n### Backend Features\n- ‚úÖ Structured logging with Serilog\n- ‚úÖ Global exception handling middleware\n- ‚úÖ Request/response logging middleware\n- ‚úÖ Database logging with search and filtering\n- ‚úÖ Error statistics and analytics\n- ‚úÖ Performance monitoring\n- ‚úÖ Custom exception types\n- ‚úÖ Log cleanup and retention policies\n\n## üìÅ Architecture\n\n### Frontend Structure\n```\nsrc/\n‚îú‚îÄ‚îÄ utils/\n‚îÇ   ‚îú‚îÄ‚îÄ logger.ts           # Main logging system\n‚îÇ   ‚îú‚îÄ‚îÄ errorHandler.ts     # Error handling utilities\n‚îÇ   ‚îî‚îÄ‚îÄ apiClient.ts        # API client with error handling\n‚îú‚îÄ‚îÄ components/\n‚îÇ   ‚îú‚îÄ‚îÄ ErrorBoundary.tsx   # React error boundary\n‚îÇ   ‚îú‚îÄ‚îÄ Toaster.tsx         # Toast notification system\n‚îÇ   ‚îî‚îÄ‚îÄ ui/toast.tsx        # Toast UI components\n‚îî‚îÄ‚îÄ hooks/\n    ‚îî‚îÄ‚îÄ use-toast.ts        # Toast hook\n```\n\n### Backend Structure\n```\nbackend/src/\n‚îú‚îÄ‚îÄ WemDashboard.API/\n‚îÇ   ‚îú‚îÄ‚îÄ Controllers/\n‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ LogsController.cs      # Log management API\n‚îÇ   ‚îú‚îÄ‚îÄ Middleware/\n‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ErrorHandlingMiddleware.cs    # Global error handling\n‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ RequestLoggingMiddleware.cs   # Request logging\n‚îÇ   ‚îî‚îÄ‚îÄ Program.cs                 # Enhanced with logging setup\n‚îú‚îÄ‚îÄ WemDashboard.Application/\n‚îÇ   ‚îú‚îÄ‚îÄ DTOs/\n‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ LogEntryDto.cs         # Log data transfer objects\n‚îÇ   ‚îú‚îÄ‚îÄ Services/\n‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ LogService.cs          # Log business logic\n‚îÇ   ‚îú‚îÄ‚îÄ Interfaces/\n‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ILogService.cs         # Log service interface\n‚îÇ   ‚îî‚îÄ‚îÄ Exceptions/\n‚îÇ       ‚îî‚îÄ‚îÄ CustomExceptions.cs    # Custom exception types\n‚îú‚îÄ‚îÄ WemDashboard.Domain/\n‚îÇ   ‚îú‚îÄ‚îÄ Entities/\n‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ LogEntry.cs            # Log entity\n‚îÇ   ‚îî‚îÄ‚îÄ Enums/\n‚îÇ       ‚îî‚îÄ‚îÄ LogLevel.cs            # Log levels\n‚îî‚îÄ‚îÄ WemDashboard.Infrastructure/\n    ‚îî‚îÄ‚îÄ Data/\n        ‚îú‚îÄ‚îÄ Configurations/\n        ‚îÇ   ‚îî‚îÄ‚îÄ LogEntryConfiguration.cs  # EF configuration\n        ‚îî‚îÄ‚îÄ WemDashboardDbContext.cs      # Updated with LogEntry\n```\n\n## üîß Usage Examples\n\n### Frontend Logging\n\n```typescript\nimport { useLogger } from '../utils/logger';\n\nfunction MyComponent() {\n  const log = useLogger();\n  \n  const handleAction = async () => {\n    try {\n      log.info('Starting user action', { action: 'updateProfile' });\n      \n      log.startTimer('profile-update');\n      await updateProfile(data);\n      log.endTimer('profile-update');\n      \n      log.info('Profile updated successfully');\n    } catch (error) {\n      log.error('Failed to update profile', { userId: user.id }, error);\n    }\n  };\n}\n```\n\n### Error Handling\n\n```typescript\nimport { useErrorHandler } from '../utils/errorHandler';\n\nfunction MyComponent() {\n  const { handleError, NetworkError } = useErrorHandler();\n  \n  const fetchData = async () => {\n    try {\n      const response = await api.get('/data');\n      return response.data;\n    } catch (error) {\n      if (error instanceof NetworkError) {\n        handleError(error, {\n          component: 'MyComponent',\n          action: 'fetchData'\n        });\n      }\n      throw error;\n    }\n  };\n}\n```\n\n### Backend Logging\n\n```csharp\n// In your controller or service\npublic class MyController : ControllerBase\n{\n    private readonly ILogger<MyController> _logger;\n    private readonly ILogService _logService;\n    \n    public async Task<IActionResult> MyAction()\n    {\n        try\n        {\n            _logger.LogInformation(\"Processing user action {UserId}\", userId);\n            \n            // Your business logic\n            \n            await _logService.LogUserActionAsync(userId, \"ProfileUpdate\", \"Updated profile settings\");\n            \n            return Ok();\n        }\n        catch (ValidationException ex)\n        {\n            _logger.LogWarning(ex, \"Validation failed for user {UserId}\", userId);\n            throw; // Will be handled by ErrorHandlingMiddleware\n        }\n        catch (Exception ex)\n        {\n            _logger.LogError(ex, \"Unexpected error in MyAction for user {UserId}\", userId);\n            throw;\n        }\n    }\n}\n```\n\n## üõ†Ô∏è Configuration\n\n### Frontend Configuration\n\nThe logger automatically configures itself based on environment:\n- **Development**: All log levels, console output, detailed errors\n- **Production**: Warning+ levels, error reporting to backend, user-friendly messages\n\n### Backend Configuration\n\nSerilog configuration in `Program.cs`:\n```csharp\nLog.Logger = new LoggerConfiguration()\n    .MinimumLevel.Debug()\n    .MinimumLevel.Override(\"Microsoft\", LogEventLevel.Information)\n    .Enrich.FromLogContext()\n    .Enrich.WithProperty(\"Application\", \"WemDashboard\")\n    .WriteTo.Console()\n    .WriteTo.File(\"logs/wemdashboard-.txt\", rollingInterval: RollingInterval.Day)\n    .WriteTo.File(\"logs/errors/wemdashboard-errors-.txt\", \n        restrictedToMinimumLevel: LogEventLevel.Warning)\n    .CreateLogger();\n```\n\n## üìä Log Management API\n\n### Endpoints\n\n#### `POST /api/logs`\nReceive log entries from frontend\n```json\n{\n  \"message\": \"User action failed\",\n  \"level\": \"ERROR\",\n  \"timestamp\": \"2025-06-28T17:00:00Z\",\n  \"context\": {\n    \"component\": \"ProfilePage\",\n    \"action\": \"updateProfile\"\n  },\n  \"error\": {\n    \"name\": \"NetworkError\",\n    \"message\": \"Request timeout\",\n    \"stack\": \"...\"\n  },\n  \"url\": \"https://app.wemdashboard.com/profile\",\n  \"userId\": \"user-123\"\n}\n```\n\n#### `GET /api/logs`\nRetrieve log entries with filtering\n```\nGET /api/logs?level=ERROR&startDate=2025-06-01&endDate=2025-06-28&page=1&pageSize=50\n```\n\n#### `GET /api/logs/statistics`\nGet error statistics and analytics\n```json\n{\n  \"totalErrors\": 45,\n  \"totalWarnings\": 123,\n  \"totalCritical\": 3,\n  \"errorsByLevel\": {\n    \"ERROR\": 45,\n    \"WARNING\": 123,\n    \"CRITICAL\": 3\n  },\n  \"errorsByComponent\": {\n    \"ProfilePage\": 12,\n    \"Dashboard\": 8\n  },\n  \"topErrors\": [\n    {\n      \"message\": \"Network timeout\",\n      \"count\": 15,\n      \"lastOccurrence\": \"2025-06-28T16:30:00Z\"\n    }\n  ]\n}\n```\n\n#### `DELETE /api/logs/cleanup`\nCleanup old log entries (Admin only)\n```\nDELETE /api/logs/cleanup?daysOld=30\n```\n\n## üîç Monitoring & Analytics\n\n### Error Statistics\n- Error counts by level, component, and time period\n- Top error messages and their frequency\n- Error trends over time\n- Performance metrics and slow requests\n\n### Log Retention\n- **Info/Debug logs**: 30 days\n- **Warning logs**: 90 days  \n- **Error/Critical logs**: Retained longer for analysis\n- Automatic cleanup job runs daily\n\n## üö® Error Types\n\n### Frontend Error Types\n```typescript\n// Custom error classes\nclass AppError extends Error\nclass NetworkError extends AppError  \nclass ValidationError extends AppError\nclass AuthenticationError extends AppError\nclass AuthorizationError extends AppError\nclass NotFoundError extends AppError\n```\n\n### Backend Exception Types\n```csharp\n// Custom exception classes\npublic class ValidationException : ApplicationException\npublic class NotFoundException : ApplicationException  \npublic class UnauthorizedException : ApplicationException\npublic class ForbiddenException : ApplicationException\npublic class ConflictException : ApplicationException\npublic class BadRequestException : ApplicationException\n```\n\n## üé® User Experience\n\n### Error Pages\nWhen errors occur, users see:\n- Friendly error message (not technical details)\n- Error ID for support reference\n- Action buttons (Retry, Go Home, Report Issue)\n- In development: Full error details for debugging\n\n### Toast Notifications\n- Success, warning, error, and info toasts\n- Auto-dismiss after configurable timeout\n- Action buttons for important notifications\n- Queue management (max 5 toasts)\n\n## üîß Development Setup\n\n### Frontend\n1. The logging system is automatically initialized in `App.tsx`\n2. Error boundaries wrap all major components\n3. Use the provided hooks and utilities\n\n### Backend  \n1. Logging is configured in `Program.cs`\n2. Middleware is automatically registered\n3. Database includes `LogEntries` table\n4. Log cleanup runs automatically\n\n## üìà Performance Impact\n\n### Frontend\n- Minimal overhead in production\n- Batched error reporting to backend\n- In-memory log buffer (max 1000 entries)\n- Async error reporting (non-blocking)\n\n### Backend\n- Structured logging with minimal serialization overhead\n- Async database writes for log entries\n- Indexed database tables for fast queries\n- Background cleanup processes\n\n## üîí Security Considerations\n\n- **PII Protection**: Sensitive data is never logged\n- **Error Sanitization**: Production errors don't expose internal details\n- **Rate Limiting**: Log endpoints are rate-limited\n- **Authentication**: Log viewing requires appropriate permissions\n- **Data Retention**: Automatic cleanup of old logs\n\n## üöÄ Getting Started\n\n1. **Run the application** - Logging is automatically enabled\n2. **Check logs** - Visit `/api/logs` (requires authentication)\n3. **View statistics** - Visit `/api/logs/statistics`\n4. **Monitor errors** - Check `logs/` directory on server\n5. **Test error handling** - Trigger errors to see the system in action\n\n## üí° Best Practices\n\n### Frontend\n- Always wrap async operations with error handling\n- Use appropriate log levels (debug ‚Üí info ‚Üí warn ‚Üí error ‚Üí fatal)\n- Include relevant context in log messages\n- Don't log sensitive user data\n- Use performance timers for slow operations\n\n### Backend\n- Use structured logging with consistent properties\n- Include correlation IDs for request tracing\n- Log business events, not just errors\n- Use appropriate log levels\n- Include relevant context (user ID, request ID, etc.)\n\n## üîÑ Future Enhancements\n\n- [ ] Real-time error notifications\n- [ ] Integration with external monitoring tools (Sentry, DataDog)\n- [ ] Error aggregation and deduplication\n- [ ] Automated error alerts based on thresholds\n- [ ] Performance profiling and APM integration\n- [ ] Log analysis and ML-based anomaly detection\n\n---\n\n**Note**: This logging system is designed to be comprehensive yet performant, providing excellent debugging capabilities in development while maintaining security and performance in production."